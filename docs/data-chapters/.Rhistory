# | echo: true
# | output: false
pip install researchpy bs4
#| echo: true
#| output: false
import json
import re
from bs4 import BeautifulSoup
import pandas as pd
import warnings
import researchpy as rp
import os
warnings.filterwarnings('ignore')
install.packages("devtools")
devtools::install_github("IRkernel/IRkernel")
IRkernel::installspec()
pip intall pyyaml
pip install pyyaml
knitr::opts_chunk$set(echo = TRUE)
library(tigris)
library(leaflet)
library(dplyr)
library(sf)
library(readr)
library(RColorBrewer)
denomination_df <- read_excel("./2020_USRC_Group_Detail.xlsx", sheet = "2020 Group by County") %>%
filter(`State Name` == "Iowa")
reticulate::repl_python()
library(dplyr)
# Violent Crimes
violent_crimes <- read.csv("violent_crimes.csv")
violent_crimes
# Community Social Context County
county_crimes <- read.csv("CommunitySocialContext_FBI_CITY_Data_20231208.csv")
county_crimes
# Community Social Context City
city_crimes <- read.csv("CommunitySocialContext_FBI_COUNTY_Data_20231208.csv")
city_crimes
View(city_crimes)
View(violent_crimes)
View(violent_crimes)
# They did start tracking the violent crimes or property crimes until 2009
# City table
city_columns <- c("time_frame", "geography_type", "geography_name", "county_sitsin_FIPS", "violentcrime", "violentcrimert", "propertycrime", "propertyrt")
city_crimes_table <- city_crimes[, city_columns]
# write.csv(city_crimes_table, "city_crimes_table.csv")
# County table
county_columns <- c("time_frame", "geography_type", "geography_name", "county_sitsin_FIPS", "violentcrime", "violentcrimert", "propertycrime", "propertyrt")
county_crimes_table <- county_crimes[, county_columns]
# write.csv(county_crimes_table, "county_crimes_table.csv")
# Getting rid of the columns that are full of NAs from the years 2005-2009
city_crimes_table_2009_2020 <- city_crimes_table %>%
filter(!is.na(violentcrime))
county_crimes_table_2009_2020 <- county_crimes_table %>%
filter(!is.na(violentcrime))
# Cleaning the data so that we only have the most recent year: 2020
city_crimes_table_2020 <- city_crimes_table %>% select(time_frame = 2020)
# Cleaning the data so that we only have the most recent year: 2020
city_crimes_table_2020 <- city_crimes_table %>% select(time_frame = "2020")
# Cleaning the data so that we only have the most recent year: 2020
city_crimes_table_2020 <- city_crimes_table %>% select("time_frame" = "2020")
# Cleaning the data so that we only have the most recent year: 2020
city_crimes_table_2020 <- city_crimes_table %>% select(time_frame == "2020")
# Cleaning the data so that we only have the most recent year: 2020
city_crimes_table_2020 <- city_crimes_table %>% filter(time_frame == "2020")
city_crimes_table_2020
View(city_crimes_table_2020)
county_crimes_table_2020 <- county_crimes_table %>% filter(time_frame == "2020")
county_crimes_table_2020
city_crimes_table_2020
View(county_crimes)
# Violent Crimes
violent_crimes <- read.csv("violent_crimes.csv")
violent_crimes
# Community Social Context County
citty_crimes <- read.csv("CommunitySocialContext_FBI_CITY_Data_20231208.csv")
cityy_crimes
# Violent Crimes
violent_crimes <- read.csv("violent_crimes.csv")
violent_crimes
# Community Social Context County
citty_crimes <- read.csv("CommunitySocialContext_FBI_CITY_Data_20231208.csv")
city_crimes
# Community Social Context City
county_crimes <- read.csv("CommunitySocialContext_FBI_COUNTY_Data_20231208.csv")
county_crimes
# They did start tracking the violent crimes or property crimes until 2009
# City table
city_columns <- c("time_frame", "geography_type", "geography_name", "county_sitsin_FIPS", "violentcrime", "violentcrimert", "propertycrime", "propertyrt")
city_crimes_table <- city_crimes[, city_columns]
# write.csv(city_crimes_table, "city_crimes_table.csv")
# County table
county_columns <- c("time_frame", "geography_type", "geography_name", "county_sitsin_FIPS", "violentcrime", "violentcrimert", "propertycrime", "propertyrt")
county_crimes_table <- county_crimes[, county_columns]
# write.csv(county_crimes_table, "county_crimes_table.csv")
write.csv(county_crimes_table, "county_crimes_table.csv")
# Getting rid of the columns that are full of NAs from the years 2005-2009
city_crimes_table_2009_2020 <- city_crimes_table %>%
filter(!is.na(violentcrime))
county_crimes_table_2009_2020 <- county_crimes_table %>%
filter(!is.na(violentcrime))
# Cleaning the data so that we only have the most recent year: 2020
city_crimes_table_2020 <- city_crimes_table %>% filter(time_frame == "2020")
county_crimes_table_2020 <- county_crimes_table %>% filter(time_frame == "2020")
city_crimes_table_2020
county_crimes_table_2020
# Violent Crimes
violent_crimes <- read.csv("violent_crimes.csv")
violent_crimes
# Community Social Context County
city_crimes <- read.csv("CommunitySocialContext_FBI_CITY_Data_20231208.csv")
city_crimes
# Community Social Context City
county_crimes <- read.csv("CommunitySocialContext_FBI_COUNTY_Data_20231208.csv")
county_crimes
# They did start tracking the violent crimes or property crimes until 2009
# City table
city_columns <- c("time_frame", "geography_type", "geography_name", "county_sitsin_FIPS", "violentcrime", "violentcrimert", "propertycrime", "propertyrt")
city_crimes_table <- city_crimes[, city_columns]
# write.csv(city_crimes_table, "city_crimes_table.csv")
# County table
county_columns <- c("time_frame", "geography_type", "geography_name", "county_sitsin_FIPS", "violentcrime", "violentcrimert", "propertycrime", "propertyrt")
county_crimes_table <- county_crimes[, county_columns]
# write.csv(county_crimes_table, "county_crimes_table.csv")
county_crimes_table
city_crimes_table
write.csv(county_crimes_table, "county_crimes_table.csv")
# Getting rid of the columns that are full of NAs from the years 2005-2009
city_crimes_table_2009_2020 <- city_crimes_table %>%
filter(!is.na(violentcrime))
county_crimes_table_2009_2020 <- county_crimes_table %>%
filter(!is.na(violentcrime))
# Cleaning the data so that we only have the most recent year: 2020
city_crimes_table_2020 <- city_crimes_table %>% filter(time_frame == "2020")
county_crimes_table_2020 <- county_crimes_table %>% filter(time_frame == "2020")
city_crimes_table_2020
county_crimes_table_2020
# Cleaning the data so that we only have the most recent year: 2020
city_crimes_table_2020 <- city_crimes_table %>% filter(time_frame == "2020")[-1,]
# Cleaning the data so that we only have the most recent year: 2020
city_crimes_table_2020 <- city_crimes_table %>% filter(time_frame == "2020") %>% slice(-1)
county_crimes_table_2020 <- county_crimes_table %>% filter(time_frame == "2020") %>% slice(-1)
View(county_crimes_table_2020)
# Populations
city_population <- read.csv("/Users/owner/Library/CloudStorage/Box-Box/DSPG follow up/Data/Capitals Data/Source Data (Raw)/Population Data/City_Population.csv")
county_population <- read.csv("/Users/owner/Library/CloudStorage/Box-Box/DSPG follow up/Data/Capitals Data/Source Data (Raw)/Population Data/County_Population.csv")
# Adding population into the city and county data set
city_crimes_table_2020 <- city_crimes_table_2020 %>% merge(city_population)
city_crimes_table_2020
# Making a table with just violent crimes (county)
county_violent_crimes_2020 <- county_crimes_table_2020 %>% select(violentcrime, violentcrimert, estimate)
# Making a table with just violent crimes (county)
county_violent_crimes_2020 <- county_crimes_table_2020 %>% select(c(violentcrime, violentcrimert, estimate))
# Making a table with just violent crimes (county)
county_violent_crimes_2020 <- county_crimes_table_2020 %>% select(violentcrime, violentcrimert, estimate)
county_crimes_table_2020 <- county_crimes_table_2020 %>% merge(county_population)
# Making a table with just violent crimes (county)
county_violent_crimes_2020 <- county_crimes_table_2020 %>% select(violentcrime, violentcrimert, estimate)
county_violent_crimes_2020
# Making a table with just violent crimes (county)
county_violent_crimes_2020 <- county_crimes_table_2020 %>% select(geography_name, violentcrime, violentcrimert, estimate)
county_violent_crimes_2020
# Making a table with just violent crimes (county)
city_violent_crimes_2020 <- city_crimes_table_2020 %>% select(geography_name, violentcrime, violentcrimert, estimate)
city_violent_crimes_2020
county_violent_crimes_2020 <- county_crimes_table_2020 %>% select(geography_name, violentcrime, violentcrimert, estimate)
county_violent_crimes_2020
# Crime rate per 10k calculation
county_violent_crimes_2020 <- county_violent_crimes_2020 %>% mutate(violentcrime_rate_10k = (violent_crime / estimate) * 10000,
propertycrime_rate_10k = (propertycrime / estimate) * 10000)
# Crime rate per 10k calculation
county_violent_crimes_2020 <- county_violent_crimes_2020 %>% mutate(violentcrime_rate_10k = (violentcrime / estimate) * 10000,
propertycrime_rate_10k = (propertycrime / estimate) * 10000)
# Crime rate per 10k calculation
county_violent_crimes_2020 <- county_violent_crimes_2020 %>% mutate(violentcrime_rate_10k = (violentcrime / estimate) * 10000, propertycrime_rate_10k = (propertycrime / estimate) * 10000)
# Crime rate per 10k calculation
county_violent_crimes_2020 <- county_violent_crimes_2020 %>% mutate(violentcrime_rate_10k = (violentcrime / estimate) * 10000, propertycrime_rate_10k = (propertycrime / estimate) * 10000)
# Crime rate per 10k calculation
county_violent_crimes_2020 <- county_crimes_table_2020 %>% mutate(violentcrime_rate_10k = (violentcrime / estimate) * 10000, propertycrime_rate_10k = (propertycrime / estimate) * 10000)
county_violent_crimes_2020
county_violent_crimes_2020 <- county_crimes_table_2020 %>% select(geography_name, violentcrime, violentcrimert, estimate)
county_violent_crimes_2020
# Crime rate per 10k calculation
county_violent_crimes_2020 <- county_crimes_table_2020 %>% mutate(violentcrime_rate_10k = (violentcrime / estimate) * 10000, propertycrime_rate_10k = (propertycrime / estimate) * 10000)
county_violent_crimes_2020
